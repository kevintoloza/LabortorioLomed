<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
      


 <!--form basico para prueba-->   
 <record model="ir.ui.view" id="lomed_form_1">
        <field name="name">lomed_form_1</field>
        <field name="model">lomed.formoptica</field>
        <field name="arch" type="xml">
         <form string="LOMED laboratorio optico">   
poner un selector, que el parent o_form_sheet
            <div id="prueba">
                <script language="Javascript">

                  var clientes;
                    var referencia = {};
                    var nombres = {};
                    $ (". o_input"). on ("presionar tecla", función (e) {
                        / * ENTRAR PRESIONADO * /
                        if (e.keyCode == 13) {
                            / * ELEMENTO DE ENFOQUE * /
                            entradas var = $ (". o_form_sheet"). find (". o_input");
                            var idx = inputs.index (esto);
    
                            if (idx == inputs.length - 1) {
                                entradas [0] .select ()
                            } más {
                                entradas [idx + 1] .focus (); // maneja los botones de envío
                               
                            }
                            falso retorno;
                        }
                    });
    

                    $ (documento) .ready (función () {
                        $ .ajax ({url: "/ select / clientes", éxito: función (resultado) {
                           // alerta (resultado)
                            clientes = JSON.parse (resultado)
                           $ .each (clientes.collection, function (i, item) {
                            referencia [item.code] = item.nombre
                            nombres [item.code] = item.id
                        
                        });
                            }
                        });

                        $ ("input [name = 'ref']"). keyup (function (event) { 
                            if (event.keyCode == 13) {
                                / * ELEMENTO DE ENFOQUE * /
                                entradas var = $ (". o_form_sheet"). find (". o_input");
                                var idx = inputs.index (esto);
        
                                if (idx == inputs.length - 1) {
                                    entradas [0] .select ()
                                } más {
                                    entradas [idx + 1] .focus (); // maneja los botones de envío
                                   
                                }
                                falso retorno;
                            }
                            x = $ ("input [nombre = 'ref']"). val ();
                            y = referencia [x];
                            z = nombres [x]
                            tratar  
                            {
                                // alerta (x);
                           
                            $ ("input [name = 'optica']"). val (y); 
                            $ ("input [name = 'optica_id']"). val (z);   
                            }
                            captura (error)
                            {
                            }
                        });
                            
                    });

                     función imprSelec (prueba) {
                      var ficha = document.getElementById (prueba);
                      var ventimp = window.open ('', 'popimpr');
                      ventimp.document.write (ficha.innerHTML);
                      ventimp.document.close ();
                      ventimp.print ();
                      ventimp.close ();
                    }
                </script>
                <field name="image" widget="html" readonly="1" invisible="1"/>
                

            </div>

            

        <header>
        <button name="aprobado" states="Borrador" string="Procesar" type="object" class="oe_highlight" onclick="javascript:imprSelec('prueba')"/>
        </header> 
        <sheet>      

        <group name="form" >    
        <field name="ref"/>
        <field name="optica"/>
      
        <field name="name"  />
        <field name="tipo_id"  />
       
        <field name="material_id"  domain="[['tipo_id','=', tipo_id]]"/>
        <field name="color_id"  domain="[['material_id','=', material_id]]" />
        <field name="lente_id"  domain="[['color_id','=', color_id]]"/>
        </group>    
       
             
             
        <group  name = " odid " >        
        <grupo >
            <field  name = " od_esfera " />
            <field  name = " od_cilindro " />
            <field  name = " od_eje " />
            <field  name = " od_adicion " />
            <field  name = " od_prisma " />
        </grupo >
         <grupo >
            <field  name = " oi_esfera " />
            <field  name = " oi_cilindro " />
            <field  name = " oi_eje " />
            <field  name = " oi_adicion " />
            <field  name = " oi_prisma " />
        </grupo >    
          
            </grupo >   
            <grupo >
            <field  name = " policar " />
            <field  name = " cr_49 " />
            <field  name = " anti " />
            <field  name = " clase " />
            <field  name = " base " />
            </grupo >
    
        <grupo >    
            <grupo >   
            <field  name = " od_alt_oblea " />
            <field  name = " od_alt_pupilar " />
            <field  name = " od_alt_lejos " />
            <field  name = " od_alt_cerca " />
            </grupo >
    
            <grupo >  
            <field  name = " oi_alt_oblea " />
            <field  name = " oi_alt_pupilar " />
            <field  name = " oi_alt_lejos " />
            <field  name = " oi_alt_cerca " />
            </grupo >
        </grupo >

            <group>  
            <field name="aro"/>
            <field name="medida"/>
            <field name="examino"/>
            <field name="asesor"/>
            <field name="fecha_entrega"/>
            <field name="color2"/>
            <field name="a"/>
            <field name="a"/>
            <field name="c"/>
            <field name="d"/>
            <field name="observaciones"/>    
            </group>
  <field name="optica_id" invisible="1"/>
   <field name="state" invisible="1" />
        </sheet>
        </form>
        </field>
        </record>



        <record model="ir.ui.view" id="lomed_formoptica_tree">
            <field name="name">lomed_formoptica_tree</field>
            <field name="model">lomed.formoptica</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="ref"/>
                    <field name="optica"/>
                    <field name="optica_id"/>
                    <field name="name"  />
               
                </tree>
            </field>
         </record>


<!--Action para prueba-->
<record model="ir.actions.act_window" id="form_lomed_action">
        <field name="name">LOMED laboratorio optico </field>
        <field name="res_model">lomed.formoptica</field>
        <field name="view_type">form</field>
        <field name="view_mode">form,tree</field>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">LOMED laboratorio optico
            </p>
        </field>
    </record>

<menuitem 
id="prueba_menu" 
name="LOMED laboratorio optico"
action="form_lomed_action"
sequence="1"
/> 


    </data>
</odoo>
        